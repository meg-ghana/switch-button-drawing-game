<!DOCTYPE HTML>
<html>
<head>
    <style>
        body {
            margin: 0;
            overflow: none;
        }
    </style>
</head>

<body>
    <canvas id="canvas"></canvas>
    <script>
        const ctx = document.getElementById('canvas').getContext('2d');
        const dims = [window.innerWidth, window.innerHeight];
        const rectThickness = 20;
        const rectCoords = [0, 0];
        const dotCoords = [];
        var rectMoving = 0; // 0 = left/right, 1 = up/down
        var change = [3, 3];

        canvas.width = dims[0];
        canvas.height = dims[1];
        ctx.globalAlpha = 0.5;
        ctx.fillStyle = "#474973";

        canvas.addEventListener('mousedown', canvasClicked, false); 

        function drawRect(x, y, w, h) {
            ctx.fillRect(x, y, w, h);
        }

        function drawLine(x1, y1, x2, y2) {
            ctx.beginPath();
            ctx.moveTo(x1, y1);
            ctx.lineTo(x2, y2);
            ctx.stroke();
        }

        function drawDots() {
            for(let i = 0; i < dotCoords.length; i++) {
                ctx.fillRect(dotCoords[i][0], dotCoords[i][1], 5, 5);
            }

            // draw lines between dots
            for(let i = 0; i < dotCoords.length - 1; i++) {
                drawLine(dotCoords[i][0], dotCoords[i][1], dotCoords[i+1][0], dotCoords[i+1][1]);
            }
        }

        function drawEverything() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // horizontally moving rectangle + vertically moving rectangle
            drawRect(rectCoords[0], 0, rectThickness, dims[1]);
            drawRect(0, rectCoords[1], dims[0], rectThickness);

            for(let i = 0; i < dotCoords.length; i++) {
                drawRect(dotCoords[i][0], dotCoords[i][1], rectThickness, rectThickness);
            }
        }

        function init() {
            // clear the canvas
            ctx.clearRect(0, 0, dims[0], dims[1]);

            // reset coordinates
            rectCoords[0] = 0;
            rectCoords[1] = 0;

            drawEverything();
        }

        function moveRect() {
            // clear the canvas
            ctx.clearRect(0, 0, dims[0], dims[1]);

            // change direction if the rectangle reaches the edge
            if (rectCoords[rectMoving] > dims[rectMoving] || rectCoords[rectMoving] < 0) {
                change[rectMoving] *= -1;
            }

            // move the rectangle
            rectCoords[rectMoving] += change[rectMoving];

            drawEverything();

            window.requestAnimationFrame(moveRect);
        }

        function canvasClicked(e) {
            if (rectMoving == 0) {
                rectMoving = 1;
            } 
            else {
                rectMoving = 0;
                dotCoords.push([...rectCoords]);
                console.log(dotCoords);
                init();
            }
        }

        init();
        moveRect();
    </script>
</body>
</html>